### This report shows all Windows 10 Computers that are out of Support ###

SELECT
   CASE
    WHEN MACHINE.OS_NUMBER ='10.0.14393' THEN '1607'
    WHEN MACHINE.OS_NUMBER ='10.0.16299' THEN '1709'
    WHEN MACHINE.OS_NUMBER ='10.0.17134' THEN '1803'
    WHEN MACHINE.OS_NUMBER ='10.0.17763' THEN '1809'
    WHEN MACHINE.OS_NUMBER ='10.0.18362' THEN '1903'    
    WHEN MACHINE.OS_NUMBER ='10.0.18363' THEN '1909'    
    WHEN MACHINE.OS_NUMBER ='10.0.19041' THEN '20H1'
    WHEN MACHINE.OS_NUMBER ='10.0.19042' THEN '20H2'
    WHEN MACHINE.OS_NUMBER ='10.0.19043' THEN '21H1'
    WHEN MACHINE.OS_NUMBER ='10.0.19044' THEN '21H2'
    WHEN MACHINE.OS_NUMBER ='10.0.19045' THEN '22H2'
    ELSE 'Super Old - Update Now'
   END AS VERSION,
	L.NAME AS 'LOCATION',
   MACHINE.NAME AS SYSTEM_NAME,
   MACHINE.OS_NAME,
   MACHINE.OS_NUMBER,
	MACHINE.IP, 
	MACHINE.MAC, 
	MACHINE.LAST_INVENTORY,
	CASE
    WHEN MACHINE.OS_NUMBER ='10.0.19044' THEN 'YES'
    WHEN MACHINE.OS_NUMBER ='10.0.19045' THEN 'YES'
    ELSE 'NO'
   END AS SUPPORTED
FROM MACHINE
	LEFT JOIN MACHINE_LABEL_JT MLJT ON MACHINE.ID = MLJT.MACHINE_ID
	LEFT JOIN LABEL L ON MLJT.LABEL_ID = L.ID
WHERE
	MACHINE.OS_NAME like 'Microsoft Windows 10%' 
GROUP BY MACHINE.NAME
ORDER BY VERSION, L.NAME ASC, MACHINE.NAME ASC
